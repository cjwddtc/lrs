cmake_minimum_required(VERSION 3.7)
project(main)
find_program(CCACHE_FOUND ccache)
if(CCACHE_FOUND)
        set_property(GLOBAL PROPERTY RULE_LAUNCH_COMPILE ccache)
        set_property(GLOBAL PROPERTY RULE_LAUNCH_LINK ccache)
endif(CCACHE_FOUND)
find_package(Boost REQUIRED COMPONENTS system filesystem)
include_directories(${Boost_INCLUDE_DIR})
link_directories(${Boost_LIBRARY_DIRS})
add_library(tcp SHARED tcp.cpp)
add_library(socket SHARED socket.cpp)
add_library(port SHARED port.cpp)
add_library(listener SHARED listener.cpp)
add_library(server SHARED server.cpp)
add_executable(main main.cpp)
target_link_libraries(tcp ${Boost_LIBRARIES} socket)
target_link_libraries(socket ${Boost_LIBRARIES})
target_link_libraries(port socket)
target_link_libraries(listener port)
target_link_libraries(server listener)
target_link_libraries(main port socket listener)
IF (WIN32)  
target_link_libraries(tcp ws2_32.lib mswsock.lib)
target_link_libraries(socket ws2_32.lib mswsock.lib)
endif(WIN32)
IF (UNIX)  
target_link_libraries(port dl)
endif(UNIX)

